#!/bin/sh

set -eu

# Minimal mock for the specific jsonfilter query used in aliddns.sh.

if [ "$1" != "-e" ]; then
	exit 1
fi

expr="$2"
input=$(cat)

if [ "$expr" = '@["ipv4-address"][0].address' ]; then
	printf '%s' "$input" | sed -n 's/.*"address"[[:space:]]*:[[:space:]]*"\([^"]*\)".*/\1/p'
elif [ "$expr" = '@.DomainRecords.Record[0].RecordId' ]; then
	printf '%s' "$input" | sed -n 's/.*"RecordId"[[:space:]]*:[[:space:]]*"\([^"]*\)".*/\1/p'
elif [ "$expr" = '@.DomainRecords.Record[0].Value' ]; then
	printf '%s' "$input" | sed -n 's/.*"Value"[[:space:]]*:[[:space:]]*"\([^"]*\)".*/\1/p'
else
	exit 1
fi
